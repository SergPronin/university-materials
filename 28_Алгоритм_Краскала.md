# 28. –ê–ª–≥–æ—Ä–∏—Ç–º –ö—Ä–∞—Å–∫–∞–ª–∞

[[27_–ê–ª–≥–æ—Ä–∏—Ç–º_–ü—Ä–∏–º–∞|‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –±–∏–ª–µ—Ç]]

---

## üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**–ê–ª–≥–æ—Ä–∏—Ç–º –ö—Ä–∞—Å–∫–∞–ª–∞**¬†—Å—Ç—Ä–æ–∏—Ç¬†**–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –æ—Å—Ç–æ–≤–Ω–æ–µ –¥–µ—Ä–µ–≤–æ (MST)**¬†–¥–ª—è —Å–≤—è–∑–Ω–æ–≥–æ –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞.

> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Ä—ë–±–µ—Ä –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É¬†**—Å–∏—Å—Ç–µ–º–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤ (DSU / Union-Find)**

---

## üß† –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

1. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ä—ë–±—Ä–∞ –ø–æ –≤–µ—Å—É (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é).
    
2. –ò–¥—Ç–∏ –ø–æ —Ä—ë–±—Ä–∞–º –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è:
    
    - –ï—Å–ª–∏ —Å–æ–µ–¥–∏–Ω—è–µ–º—ã–µ –≤–µ—Ä—à–∏–Ω—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è¬†**–≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö**, –¥–æ–±–∞–≤–ª—è–µ–º —Ä–µ–±—Ä–æ –≤ MST –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.
        
3. –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è, –∫–æ–≥–¥–∞ MST —Å–æ–¥–µ—Ä–∂–∏—Ç¬†`V - 1`¬†—Ä—ë–±–µ—Ä.
    

---

## üìê –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä (–≤—Ä—É—á–Ω—É—é)

–ì—Ä–∞—Ñ:

```
     2       3
  A-----B-------C
   \     |     /
   6\    8|   /5
     \   |  /
        D
```

–†—ë–±—Ä–∞ (–≤–µ—Å): A‚ÄìB(2), B‚ÄìC(3), C‚ÄìD(5), A‚ÄìD(6), B‚ÄìD(8)

### –¢–∞–±–ª–∏—Ü–∞ —à–∞–≥–æ–≤:

|–®–∞–≥|–†–µ–±—Ä–æ|–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–æ|–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ—Å–ª–µ|–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ MST?|–í–µ—Å MST|
|---|---|---|---|---|---|
|1|A‚ÄìB(2)|{A}, {B}|{A,B}|‚úÖ|2|
|2|B‚ÄìC(3)|{A,B}, {C}|{A,B,C}|‚úÖ|5|
|3|C‚ÄìD(5)|{A,B,C}, {D}|{A,B,C,D}|‚úÖ|10|
|4|A‚ÄìD(6)|{A,B,C,D}|‚Äî|‚ùå|10|
|5|B‚ÄìD(8)|{A,B,C,D}|‚Äî|‚ùå|10|

–ò—Ç–æ–≥–æ–≤–æ–µ MST: A‚ÄìB, B‚ÄìC, C‚ÄìD (–≤–µ—Å 10)

---

## üñº –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è MST

–î–æ:

```
     2       3
  A-----B-------C
   \     |     /
   6\    8|   /5
     \   |  /
        D
```

–ü–æ—Å–ª–µ:

```
     2       3
  A-----B-------C
                 \
                  5
                   \
                    D
```

---

## üîÅ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –ü—Ä–∏–º vs –ö—Ä–∞—Å–∫–∞–ª

|–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞|–ü—Ä–∏–º|–ö—Ä–∞—Å–∫–∞–ª|
|---|---|---|
|–°—Ç–∞—Ä—Ç–æ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞|–¢—Ä–µ–±—É–µ—Ç—Å—è|–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è|
|–°—Ç—Ä—É–∫—Ç—É—Ä–∞|–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ—á–µ—Ä–µ–¥—å|–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä—ë–±–µ—Ä + DSU|
|–£–¥–æ–±–µ–Ω –¥–ª—è|–ü–ª–æ—Ç–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤|–†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤|
|–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—ë–±–µ—Ä|–õ–æ–∫–∞–ª—å–Ω–æ, –æ—Ç —Ç–µ–∫—É—â–∏—Ö –≤–µ—Ä—à–∏–Ω|–ì–ª–æ–±–∞–ª—å–Ω–æ, –≤ –ø–æ—Ä—è–¥–∫–µ –≤–µ—Å–∞|
|–°–ª–æ–∂–Ω–æ—Å—Ç—å|O(E log V)|O(E log E)|

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏

1. –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ DSU –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ –ö—Ä–∞—Å–∫–∞–ª–∞?
    
2. –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ?
    
3. –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –ö—Ä–∞—Å–∫–∞–ª –ª—É—á—à–µ –ü—Ä–∏–º–∞?
    
4. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ –≤ –≥—Ä–∞—Ñ–µ –µ—Å—Ç—å —Ü–∏–∫–ª?
    
5. –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ MST –≥–æ—Ç–æ–≤?
    

---

## üß© –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Java

```java
class Edge implements Comparable<Edge> {
    int from, to, weight;
    Edge(int from, int to, int weight) {
        this.from = from;
        this.to = to;
        this.weight = weight;
    }
    public int compareTo(Edge other) {
        return this.weight - other.weight;
    }
}

class DSU {
    int[] parent;
    DSU(int n) {
        parent = new int[n];
        for (int i = 0; i < n; i++) parent[i] = i;
    }
    int find(int x) {
        if (parent[x] != x) parent[x] = find(parent[x]);
        return parent[x];
    }
    void union(int x, int y) {
        parent[find(x)] = find(y);
    }
}

List<Edge> edges = ...;
Collections.sort(edges);
DSU dsu = new DSU(V);
int mstWeight = 0;

for (Edge e : edges) {
    if (dsu.find(e.from) != dsu.find(e.to)) {
        dsu.union(e.from, e.to);
        mstWeight += e.weight;
    }
}

System.out.println("MST weight = " + mstWeight);
```

---

## üìà –°–ª–æ–∂–Ω–æ—Å—Ç—å

- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä—ë–±–µ—Ä:¬†**O(E log E)**
    
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è:¬†**–ø–æ—á—Ç–∏ O(1)**¬†–±–ª–∞–≥–æ–¥–∞—Ä—è –ø—É—Ç–∏ —Å–∂–∞—Ç–∏—è (Union by Rank + Path Compression)
    
- –ò—Ç–æ–≥:¬†**O(E log E)**
    

---

## ‚úÖ –í—ã–≤–æ–¥—ã

- –†–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞¬†**—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∞—Ö**
    
- –¢—Ä–µ–±—É–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ä—ë–±–µ—Ä –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã DSU
    
- –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ü—Ä–∏–º–∞, –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –≤–µ—Ä—à–∏–Ω—ã
    
- –£–¥–æ–±–µ–Ω –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è MST (–µ—Å–ª–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä—ë–±—Ä–∞)
    

---

[[27_–ê–ª–≥–æ—Ä–∏—Ç–º_–ü—Ä–∏–º–∞|‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –±–∏–ª–µ—Ç]]