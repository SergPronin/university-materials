# 18. AVL-–¥–µ—Ä–µ–≤—å—è: –∏–¥–µ—è, –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞, –æ—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

[[17_–ú–Ω–æ–∂–µ—Å—Ç–≤–æ_–∏_—Å–ª–æ–≤–∞—Ä—å_–Ω–∞_–ë–î–ü|‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –±–∏–ª–µ—Ç]] | [[19_–ö—Ä–∞—Å–Ω–æ_—á–µ—Ä–Ω—ã–µ_–¥–µ—Ä–µ–≤—å—è|‚Üí –°–ª–µ–¥—É—é—â–∏–π –±–∏–ª–µ—Ç]]

---

## üå≥ –ß—Ç–æ —Ç–∞–∫–æ–µ AVL-–¥–µ—Ä–µ–≤–æ

**AVL-–¥–µ—Ä–µ–≤–æ**¬†‚Äî —ç—Ç–æ¬†**—Å–∞–º–æ–±–∞–ª–∞–Ω—Å–∏—Ä—É—é—â–µ–µ—Å—è –¥–≤–æ–∏—á–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –ø–æ–∏—Å–∫–∞**, –≤ –∫–æ—Ç–æ—Ä–æ–º¬†**—Ä–∞–∑–Ω–∏—Ü–∞ –≤—ã—Å–æ—Ç**¬†–º–µ–∂–¥—É –ª–µ–≤—ã–º –∏ –ø—Ä–∞–≤—ã–º –ø–æ–¥–¥–µ—Ä–µ–≤–æ–º¬†**–ª—é–±–æ–≥–æ —É–∑–ª–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 1**.

> –ù–∞–∑–≤–∞–Ω–æ –≤ —á–µ—Å—Ç—å –∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª–µ–π: –ê–¥–µ–ª—å—Å–æ–Ω-–í–µ–ª—å—Å–∫–∏–π –∏ –õ–∞–Ω–¥–∏—Å (1962)

---

## ‚öñÔ∏è –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

**–ë–∞–ª–∞–Ω—Å-—Ñ–∞–∫—Ç–æ—Ä (BF)**¬†—É–∑–ª–∞ =¬†`–≤—ã—Å–æ—Ç–∞(–ø—Ä–∞–≤–æ–µ) ‚àí –≤—ã—Å–æ—Ç–∞(–ª–µ–≤–æ–µ)`

–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è BF: -1, 0, +1

–ï—Å–ª–∏ –Ω–∞—Ä—É—à–µ–Ω–æ ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è¬†**–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Å –ø–æ–º–æ—â—å—é –ø–æ–≤–æ—Ä–æ—Ç–æ–≤**:

- LL: –ø—Ä–∞–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç
    
- RR: –ª–µ–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç
    
- LR: –ª–µ–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç —É –ø–æ—Ç–æ–º–∫–∞, –ø–æ—Ç–æ–º –ø—Ä–∞–≤—ã–π
    
- RL: –ø—Ä–∞–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç —É –ø–æ—Ç–æ–º–∫–∞, –ø–æ—Ç–æ–º –ª–µ–≤—ã–π
    

---

## üîÅ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–≤–æ—Ä–æ—Ç–æ–≤

### ‚ñ∂Ô∏è LL (Left-Left) ‚Äî –ø—Ä–∞–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç

```
      30                20
     /     ‚Üí          /  \
   20               10   30
  /
10
```

### ‚ñ∂Ô∏è RR (Right-Right) ‚Äî –ª–µ–≤—ã–π –ø–æ–≤–æ—Ä–æ—Ç

```
  10                  20
    \     ‚Üí         /   \
    20             10   30
      
      30
```

### ‚ñ∂Ô∏è LR (Left-Right) ‚Äî —Å–Ω–∞—á–∞–ª–∞ –ª–µ–≤—ã–π, –∑–∞—Ç–µ–º –ø—Ä–∞–≤—ã–π

```
    30               30              20
   /     ‚Üí          /      ‚Üí       /  \
  10              20              10  30
    \            /
     20         10
```

### ‚ñ∂Ô∏è RL (Right-Left) ‚Äî —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–∞–≤—ã–π, –∑–∞—Ç–µ–º –ª–µ–≤—ã–π

```
  10                10                 20
    \     ‚Üí           \       ‚Üí       /  \
     30               20             10  30
    /                   \
   20                   30
```

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–∑–ª–∞ AVL

```java
class Node {
    int key, height;
    Node left, right;

    Node(int key) {
        this.key = key;
        this.height = 1;
    }
}
```

---

## ‚ûï –í—Å—Ç–∞–≤–∫–∞ —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π

```java
Node insert(Node node, int key) {
    if (node == null) return new Node(key);

    if (key < node.key) node.left = insert(node.left, key);
    else if (key > node.key) node.right = insert(node.right, key);
    else return node;

    updateHeight(node);
    return balance(node);
}

void updateHeight(Node node) {
    node.height = 1 + Math.max(height(node.left), height(node.right));
}

int height(Node node) {
    return node == null ? 0 : node.height;
}
```

---

## ‚öôÔ∏è –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

```java
Node balance(Node node) {
    int bf = getBalance(node);

    if (bf > 1) {
        if (getBalance(node.right) < 0)
            node.right = rotateRight(node.right); // RL
        return rotateLeft(node); // RR
    }

    if (bf < -1) {
        if (getBalance(node.left) > 0)
            node.left = rotateLeft(node.left); // LR
        return rotateRight(node); // LL
    }

    return node;
}

int getBalance(Node node) {
    return height(node.right) - height(node.left);
}
```

---

## üîÑ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–≤–æ—Ä–æ—Ç–æ–≤

```java
Node rotateRight(Node y) {
    Node x = y.left;
    Node T2 = x.right;

    x.right = y;
    y.left = T2;

    updateHeight(y);
    updateHeight(x);

    return x;
}

Node rotateLeft(Node x) {
    Node y = x.right;
    Node T2 = y.left;

    y.left = x;
    x.right = T2;

    updateHeight(x);
    updateHeight(y);

    return y;
}
```

---

## ‚ùå –£–¥–∞–ª–µ–Ω–∏–µ

1. –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏ —É–¥–∞–ª—è–µ–º –µ–≥–æ, –∫–∞–∫ –≤ BST
    
2. –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è ‚Äî¬†`updateHeight()`¬†–∏¬†`balance()`¬†–≤–≤–µ—Ä—Ö –ø–æ –¥–µ—Ä–µ–≤—É
    

> –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –ø—É—Ç–∏ –æ—Ç —É–¥–∞–ª—è–µ–º–æ–≥–æ —É–∑–ª–∞ –∫ –∫–æ—Ä–Ω—é

---

## üìà –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π

|–û–ø–µ—Ä–∞—Ü–∏—è|–°–ª–æ–∂–Ω–æ—Å—Ç—å|
|---|---|
|–ü–æ–∏—Å–∫|O(log n)|
|–í—Å—Ç–∞–≤–∫–∞|O(log n)|
|–£–¥–∞–ª–µ–Ω–∏–µ|O(log n)|

AVL-–¥–µ—Ä–µ–≤—å—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç¬†**–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫—É—é –≤—ã—Å–æ—Ç—É**¬†–¥–∞–∂–µ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ

---

## ‚úÖ –í—ã–≤–æ–¥—ã

- AVL-–¥–µ—Ä–µ–≤–æ —Å—Ç—Ä–æ–≥–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ: —Ä–∞–∑–Ω–∏—Ü–∞ –≤—ã—Å–æ—Ç ‚â§ 1
    
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–≤–æ—Ä–æ—Ç—ã (LL, RR, LR, RL) –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
    
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞, –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è
    

---

[[19_–ö—Ä–∞—Å–Ω–æ_—á–µ—Ä–Ω—ã–µ_–¥–µ—Ä–µ–≤—å—è|‚Üí –°–ª–µ–¥—É—é—â–∏–π –±–∏–ª–µ—Ç: –ö—Ä–∞—Å–Ω–æ-—á–µ—Ä–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è]]